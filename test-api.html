<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API í…ŒìŠ¤íŠ¸</title>
</head>
<body>
    <h1>ê³µê³µë°ì´í„°í¬í„¸ API í…ŒìŠ¤íŠ¸</h1>
    
    <div>
        <h2>1. ê¸°ë³¸ API í…ŒìŠ¤íŠ¸ (areaCode)</h2>
        <button onclick="testBasicAPI()">ê¸°ë³¸ API í…ŒìŠ¤íŠ¸</button>
        <div id="basic-result"></div>
    </div>
    
    <div>
        <h2>2. ì¶•ì œ API í…ŒìŠ¤íŠ¸ (searchFestival2)</h2>
        <button onclick="testFestivalAPI()">ì¶•ì œ API í…ŒìŠ¤íŠ¸</button>
        <div id="festival-result"></div>
    </div>
    
    <div>
        <h2>3. ì§ì ‘ API í˜¸ì¶œ í…ŒìŠ¤íŠ¸</h2>
        <button onclick="testDirectAPI()">ì§ì ‘ API í˜¸ì¶œ</button>
        <div id="direct-result"></div>
    </div>
    
    <div>
        <h2>4. í”„ë¡ì‹œ ì—°ê²° í…ŒìŠ¤íŠ¸</h2>
        <button onclick="testProxyConnection()">í”„ë¡ì‹œ ì—°ê²° í…ŒìŠ¤íŠ¸</button>
        <div id="proxy-result"></div>
    </div>
    
    <div>
        <h2>5. ê°„ë‹¨í•œ GET ìš”ì²­ í…ŒìŠ¤íŠ¸</h2>
        <button onclick="testSimpleGet()">ê°„ë‹¨í•œ GET ìš”ì²­</button>
        <div id="simple-result"></div>
    </div>

    <script>
        const API_KEY = 'UxGu0qkZpzkbKj1TkyefegskQ9MNmCQf2gAnEc9yeHLuY6bpBT0CHXbEIu+YebmRqLeV4RoqzgpZbvuOYhnQuQ==';
        
        async function testBasicAPI() {
            const resultDiv = document.getElementById('basic-result');
            resultDiv.innerHTML = 'í…ŒìŠ¤íŠ¸ ì¤‘...';
            
            try {
                const url = `/api/public-data/B551011/KorService2/areaCode?serviceKey=${encodeURIComponent(API_KEY)}&_type=json&numOfRows=5&pageNo=1`;
                console.log('ğŸ§ª í…ŒìŠ¤íŠ¸ URL:', url);
                console.log('ğŸ”‘ API í‚¤ ê¸¸ì´:', API_KEY.length);
                console.log('ğŸ”‘ API í‚¤ (ì²˜ìŒ 20ì):', API_KEY.substring(0, 20));
                
                const response = await fetch(url);
                console.log('ğŸ“¡ ì‘ë‹µ ìƒíƒœ:', response.status);
                console.log('ğŸ“¡ ì‘ë‹µ ìƒíƒœ í…ìŠ¤íŠ¸:', response.statusText);
                console.log('ğŸ“¡ ì‘ë‹µ í—¤ë”:', Object.fromEntries(response.headers.entries()));
                
                if (response.ok) {
                    const data = await response.json();
                    console.log('ğŸ“Š ì‘ë‹µ ë°ì´í„°:', data);
                    resultDiv.innerHTML = `<pre>âœ… ì„±ê³µ: ${JSON.stringify(data, null, 2)}</pre>`;
                } else {
                    console.error('âŒ HTTP ì˜¤ë¥˜:', response.status, response.statusText);
                    resultDiv.innerHTML = `<pre>âŒ HTTP ì˜¤ë¥˜: ${response.status} ${response.statusText}</pre>`;
                }
            } catch (error) {
                console.error('âŒ ë„¤íŠ¸ì›Œí¬/ê¸°íƒ€ ì˜¤ë¥˜:', error);
                console.error('âŒ ì˜¤ë¥˜ íƒ€ì…:', error.constructor.name);
                console.error('âŒ ì˜¤ë¥˜ ìŠ¤íƒ:', error.stack);
                resultDiv.innerHTML = `<pre>âŒ ì˜¤ë¥˜: ${error.message}\n\níƒ€ì…: ${error.constructor.name}</pre>`;
            }
        }
        
        async function testFestivalAPI() {
            const resultDiv = document.getElementById('festival-result');
            resultDiv.innerHTML = 'í…ŒìŠ¤íŠ¸ ì¤‘...';
            
            try {
                const url = `/api/public-data/B551011/KorService2/searchFestival2?serviceKey=${encodeURIComponent(API_KEY)}&MobileOS=ETC&MobileApp=ê°ˆë˜ë§ë˜ë‚ ì”¨ì—¬í–‰&_type=json&numOfRows=5&pageNo=1`;
                console.log('ì¶•ì œ API URL:', url);
                
                const response = await fetch(url);
                console.log('ì¶•ì œ API ì‘ë‹µ ìƒíƒœ:', response.status);
                
                if (response.ok) {
                    const data = await response.json();
                    console.log('ì¶•ì œ API ì‘ë‹µ ë°ì´í„°:', data);
                    resultDiv.innerHTML = `<pre>âœ… ì„±ê³µ: ${JSON.stringify(data, null, 2)}</pre>`;
                } else {
                    resultDiv.innerHTML = `<pre>âŒ ì‹¤íŒ¨: ${response.status} ${response.statusText}</pre>`;
                }
            } catch (error) {
                console.error('ì¶•ì œ API ì˜¤ë¥˜:', error);
                resultDiv.innerHTML = `<pre>âŒ ì˜¤ë¥˜: ${error.message}</pre>`;
            }
        }
        
        async function testDirectAPI() {
            const resultDiv = document.getElementById('direct-result');
            resultDiv.innerHTML = 'í…ŒìŠ¤íŠ¸ ì¤‘...';
            
            try {
                const url = `https://apis.data.go.kr/B551011/KorService2/areaCode?serviceKey=${encodeURIComponent(API_KEY)}&_type=json&numOfRows=5&pageNo=1`;
                console.log('ğŸŒ ì§ì ‘ API URL:', url);
                
                const response = await fetch(url);
                console.log('ğŸŒ ì§ì ‘ API ì‘ë‹µ ìƒíƒœ:', response.status);
                
                if (response.ok) {
                    const data = await response.json();
                    console.log('ğŸŒ ì§ì ‘ API ì‘ë‹µ ë°ì´í„°:', data);
                    resultDiv.innerHTML = `<pre>âœ… ì„±ê³µ: ${JSON.stringify(data, null, 2)}</pre>`;
                } else {
                    resultDiv.innerHTML = `<pre>âŒ ì‹¤íŒ¨: ${response.status} ${response.statusText}</pre>`;
                }
            } catch (error) {
                console.error('ğŸŒ ì§ì ‘ API ì˜¤ë¥˜:', error);
                resultDiv.innerHTML = `<pre>âŒ ì˜¤ë¥˜: ${error.message}</pre>`;
            }
        }
        
        async function testProxyConnection() {
            const resultDiv = document.getElementById('proxy-result');
            resultDiv.innerHTML = 'í…ŒìŠ¤íŠ¸ ì¤‘...';
            
            try {
                // í”„ë¡ì‹œ ê²½ë¡œê°€ ì¡´ì¬í•˜ëŠ”ì§€ í…ŒìŠ¤íŠ¸
                const url = '/api/public-data/test';
                console.log('ğŸ”— í”„ë¡ì‹œ ì—°ê²° í…ŒìŠ¤íŠ¸ URL:', url);
                
                const response = await fetch(url);
                console.log('ğŸ”— í”„ë¡ì‹œ ì‘ë‹µ ìƒíƒœ:', response.status);
                console.log('ğŸ”— í”„ë¡ì‹œ ì‘ë‹µ ìƒíƒœ í…ìŠ¤íŠ¸:', response.statusText);
                
                if (response.status === 404) {
                    resultDiv.innerHTML = `<pre>âœ… í”„ë¡ì‹œ ì—°ê²°ë¨ (404ëŠ” ì •ìƒ - ê²½ë¡œë§Œ ì¡´ì¬)</pre>`;
                } else if (response.ok) {
                    resultDiv.innerHTML = `<pre>âœ… í”„ë¡ì‹œ ì—°ê²°ë¨ (200 ì‘ë‹µ)</pre>`;
                } else {
                    resultDiv.innerHTML = `<pre>âš ï¸ í”„ë¡ì‹œ ì‘ë‹µ: ${response.status} ${response.statusText}</pre>`;
                }
            } catch (error) {
                console.error('ğŸ”— í”„ë¡ì‹œ ì—°ê²° ì˜¤ë¥˜:', error);
                resultDiv.innerHTML = `<pre>âŒ í”„ë¡ì‹œ ì—°ê²° ì‹¤íŒ¨: ${error.message}</pre>`;
            }
        }
        
        async function testSimpleGet() {
            const resultDiv = document.getElementById('simple-result');
            resultDiv.innerHTML = 'í…ŒìŠ¤íŠ¸ ì¤‘...';
            
            try {
                // ê°€ì¥ ê°„ë‹¨í•œ GET ìš”ì²­ í…ŒìŠ¤íŠ¸
                const url = '/api/public-data/';
                console.log('ğŸ§ª ê°„ë‹¨í•œ GET ìš”ì²­ URL:', url);
                
                const response = await fetch(url, {
                    method: 'GET',
                    headers: {
                        'Accept': 'application/json',
                        'Content-Type': 'application/json'
                    }
                });
                
                console.log('ğŸ§ª ê°„ë‹¨í•œ GET ì‘ë‹µ ìƒíƒœ:', response.status);
                console.log('ğŸ§ª ê°„ë‹¨í•œ GET ì‘ë‹µ ìƒíƒœ í…ìŠ¤íŠ¸:', response.statusText);
                
                resultDiv.innerHTML = `<pre>ğŸ“¡ ì‘ë‹µ: ${response.status} ${response.statusText}</pre>`;
                
            } catch (error) {
                console.error('ğŸ§ª ê°„ë‹¨í•œ GET ì˜¤ë¥˜:', error);
                resultDiv.innerHTML = `<pre>âŒ ì˜¤ë¥˜: ${error.message}</pre>`;
            }
        }
    </script>
</body>
</html>
